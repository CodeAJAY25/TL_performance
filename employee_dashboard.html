<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Employee Performance Dashboard</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    
    <link rel="stylesheet" href="employee.css">    
    
    <!-- Chart.js library -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
    <!-- SheetJS library for Excel parsing -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body class="font-sans">

    <div class="dashboard-container">
        
        <!-- HEADER -->
        <div class="header-content flex justify-between items-center py-6 mb-4 border-b border-gray-200">
            <h1 class="text-3xl font-extrabold text-gray-900" id="dashboardTitle">ðŸ‘¤ Individual Employee Performance & Progress</h1>
            <a href="index.html" class="switch-button">
                Switch to TL Dashboard
            </a>
        </div>
        <!-- END HEADER -->

        <!-- CONTROLS -->
        <div class="controls grid md:grid-cols-5 gap-4 bg-white p-4 rounded-xl shadow-lg mb-6">
            <div class="control-group">
                <label for="dataFile">Upload Data (Excel .xlsx/.xls):</label>
                <input type="file" id="dataFile" accept=".xlsx,.xls" onchange="handleFileUpload(event)" class="w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-violet-50 file:text-violet-700 hover:file:bg-violet-100">
            </div>
            
            <div class="control-group">
                <label for="startDateFilter">Start Date:</label>
                <input type="date" id="startDateFilter" onchange="renderDashboard()" class="w-full border border-gray-300 rounded-lg p-2 focus:ring-blue-500 focus:border-blue-500">
            </div>
            
            <div class="control-group">
                <label for="endDateFilter">End Date:</label>
                <input type="date" id="endDateFilter" onchange="renderDashboard()" class="w-full border border-gray-300 rounded-lg p-2 focus:ring-blue-500 focus:border-blue-500">
            </div>

            <div class="control-group">
                <label for="employeeFilter">Filter by Employee:</label>
                <select id="employeeFilter" onchange="renderDashboard()" class="w-full border border-gray-300 rounded-lg p-2 bg-white focus:ring-blue-500 focus:border-blue-500">
                    <option value="none">Select Employee</option>
                </select>
            </div>
            
            <div class="control-group">
                <label for="tlFilter">Filter by Team Lead:</label>
                <select id="tlFilter" onchange="renderDashboard()" class="w-full border border-gray-300 rounded-lg p-2 bg-white focus:ring-blue-500 focus:border-blue-500">
                    <option value="all">All Team Leads</option>
                </select>
            </div>
            
        </div>
        <!-- END CONTROLS -->

        <!-- KPIS -->
        <div class="kpi-cards">
            <div class="kpi-card">
                <!-- MODIFICATION: Clarified that Volume is for the period -->
                <h3>Total Task Handled (Selected Period)</h3>
                <p id="kpiVolume">0</p>
            </div>
            <div class="kpi-card">
                <h3>Overall Average AHT (s)</h3>
                <p id="kpiAHT">0</p>
            </div>
            
            <div class="kpi-card">
                <h3>Avg Notification AHT (s)</h3>
                <p id="kpiNotifAHT">0</p>
            </div>
            
            <div class="kpi-card">
                <h3>Avg Room Status AHT (s)</h3>
                <p id="kpiRoomAHT">0</p>
            </div>
            
            <div class="kpi-card">
                <h3>Avg Zone Event AHT (s)</h3>
                <p id="kpiZoneAHT">0</p>
            </div>
        </div>
        <!-- END KPIS -->
        
        <!-- PERFORMANCE FEEDBACK -->
        <div id="performanceFeedbackContainer" class="p-4 mt-4 mb-6 rounded-lg border-l-4 bg-gray-100 text-gray-700 shadow-md">
            <p class="font-semibold">Performance Review:</p>
            <p class="mt-1">Select an employee and upload data to view performance feedback.</p>
        </div>
        <!-- END PERFORMANCE FEEDBACK -->

        <!-- DAILY TRENDS SECTION -->
        <h2 class="text-2xl font-semibold text-gray-800 mb-4 mt-6">Employee Daily Trend</h2>
        <div class="chart-grid-employee">
            <!-- 1. Volume Trend -->
            <div class="chart-card bg-white p-4 rounded-xl shadow-lg">
                <h2 class="text-lg font-medium mb-2">Daily Volume Trend</h2>
                <p id="volumeTrendMessage" style="display:block;" class="text-sm text-gray-500">Select an employee to view the daily volume trend.</p>
                <canvas id="volumeTrendChart" style="display:none;"></canvas>
            </div>
            
            <!-- 2. Overall AHT Trend -->
            <div class="chart-card bg-white p-4 rounded-xl shadow-lg">
                <h2 class="text-lg font-medium mb-2">Daily Overall AHT Trend (s)</h2>
                <p id="ahtTrendMessage" style="display:block;" class="text-sm text-gray-500">Select an employee to view the daily AHT trend.</p>
                <canvas id="ahtTrendChart" style="display:none;"></canvas>
            </div>

            <!-- 3. Notification AHT Trend (NEW) -->
            <div class="chart-card bg-white p-4 rounded-xl shadow-lg">
                <h2 class="text-lg font-medium mb-2">Daily Notification AHT Trend (s)</h2>
                <p id="notifAHTTrendMessage" style="display:block;" class="text-sm text-gray-500">Select an employee to view the daily Notification AHT trend.</p>
                <canvas id="notifAHTTrendChart" style="display:none;"></canvas>
            </div>
            
            <!-- 4. Room Status AHT Trend (NEW) -->
            <div class="chart-card bg-white p-4 rounded-xl shadow-lg">
                <h2 class="text-lg font-medium mb-2">Daily Room Status AHT Trend (s)</h2>
                <p id="roomAHTTrendMessage" style="display:block;" class="text-sm text-gray-500">Select an employee to view the daily Room Status AHT trend.</p>
                <canvas id="roomAHTTrendChart" style="display:none;"></canvas>
            </div>

            <!-- 5. Zone Event AHT Trend (NEW) -->
            <div class="chart-card bg-white p-4 rounded-xl shadow-lg">
                <h2 class="text-lg font-medium mb-2">Daily Zone Event AHT Trend (s)</h2>
                <p id="zoneAHTTrendMessage" style="display:block;" class="text-sm text-gray-500">Select an employee to view the daily Zone Event AHT trend.</p>
                <canvas id="zoneAHTTrendChart" style="display:none;"></canvas>
            </div>
        </div>
        <!-- END DAILY TRENDS SECTION -->
        
        <!-- DAILY DETAILS TABLE -->
        <div id="dailyDetailsContainer" class="mt-8">
            <h2 class="text-2xl font-semibold text-gray-800 mb-2 emp_records">Daily Performance Details</h2>
            <p id="dailyDetailTitle" class="text-sm text-gray-500 mb-4">Select an employee to view their daily records.</p>
        </div>
        <!-- END DAILY DETAILS TABLE -->
    </div>

    <!-- The script file contains the logic for calculating metrics and rendering the dashboard -->
    <script src="employee_script.js"></script>
</body>
</html>